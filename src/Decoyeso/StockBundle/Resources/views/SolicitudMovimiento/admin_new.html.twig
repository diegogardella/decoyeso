{% extends "CoobixAdminBundle:Default:new.html.twig" %}
{% import "PedidoBundle:Pedido:macros.html.twig" as macrosPedido %}

{%block main_path%}
<ul>
	<li><a class="btn_back_to_list txt16 txt_green" href="{{ path('cliente_edit',{'id':entity.pedido.cliente.id}) }}">Cliente: {{entity.pedido.cliente}}</a></li>
	<li> > <a class="btn_back_to_list txt16 txt_green" href="{{ path('pedido_edit',{'id':entity.pedido.id}) }}">Pedido: {{entity.pedido }}</a></li>
	<li> > <a class="btn_back_to_list txt16 txt_green" href="{{path('solicitudmovimiento_new',{'paramPedido':entity.pedido.id})}}">Crear Solicitud a Stock</a></li>
</ul>
{%endblock main_path%}

{% block module_tit %}
Crear solicitud
{% endblock module_tit %}


{% block menuOpciones %}{% endblock menuOpciones %}

{% block menuAcciones %}
	<a  class="btn_blue right" href="{{ path('solicitudmovimiento_por_pedido',{'pedido': entity.pedido.id}) }}">Listar Solicitudes a Stock del Pedido</a>
{% endblock menuAcciones %}

{% block list_path %}
	{{ path('solicitudmovimiento') }}
{% endblock list_path %}

{% block module_content_antes%}

<div class="tab_container border_radius">
		
		<table class="records_list">
			<thead>
				<tr>					
					<th width="450" >Producto/Insumo</th>
					<th align="center" >Cant. Presupuestada</th>
					<th align="center" >Cant. Solicitada</th>
					<th align="center" >Cant. Entregada</th>
					<th align="center" >Cant. En Stock</th>
				</tr>
			</thead>
					
			<tbody>
			{% for arrayElementosCantidad in arrayElementosCantidades %}
				<tr>
					<td >{{ arrayElementosCantidad.designacion  }}</td>
					<td align="center">{{ arrayElementosCantidad.cantidadPresupuesto  }}</td>
					<td align="center">{{ arrayElementosCantidad.cantidadSolicitada  }}</td>
					<td align="center">{{ arrayElementosCantidad.cantidadEntregada  }}</td>
					<td align="center">{{ arrayElementosCantidad.cantidadEnStock  }}</td>
				</tr>
			{% endfor %}
			</tbody>
			
		</table>
							
	</div>
	
	<hr>

{% endblock module_content_antes%}

{% block form_content %}
	{% block errorMsj %}{% endblock errorMsj %}
	
	
	<form novalidate action="{% block create_path %}{{ path('solicitudmovimiento_create') }}{% endblock create_path %}" method="post" {{ form_enctype(form) }}>
		{% form_theme form 'CoobixAdminBundle:Form:Fields.html.twig' %}
		
		<div  class="form_row">
			
				<label class=" required" >Pedido</label>
				<div class="field_widget">{{ entity.pedido }}</div>
		</div>
		
		{{ form_row(form.direccionDestino) }}
		
		<div style="display:none">{{ form_row(form.pedido) }}</div>
		<div class="form_row" id="div_solicitudmovimiento_direccionDestino">
			<label class=" required" for="solicitudmovimiento_direccionDestino">Fecha y Hora Requerido</label>
			<div class="field_widget">{{ form_widget(form.fechaHoraRequerido.date.day) }}/{{ form_widget(form.fechaHoraRequerido.date.month) }}/{{ form_widget(form.fechaHoraRequerido.date.year) }}&nbsp;&nbsp; {{ form_widget(form.fechaHoraRequerido.time.hour) }}:{{ form_widget(form.fechaHoraRequerido.time.minute) }}</div>
		</div>
		
		{{ form_row(form.observacion) }}
		{{ form_rest(form) }}
		
		<input type="hidden" name="solicitudmovimiento[elementos]" id="solicitudmovimiento_elementos" value=''>
		
		<div  class="form_row">
			
				<label class=" required" >Productos/Insumos</label>
				<div class="field_widget">
				
				<div class="tab_container border_radius">
					<table  class="records_list field_widget_elementos" id="tableListElementos">
					  <thead>
						<tr>
							<th>Nombre</th>
							<th>Cantidad</th>
							<th></th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>
								<select name="selectElementos" id="idSelectElemento" style="float:left;">
									{% for elemento in elementos %}
										<option value="{{elemento.id}}@{{ elemento.unidad }}">{{elemento.nombre}}</option>
									{%else%}
										<option value="0@0">No existen productos o insumos para agregar</option>
									{%endfor%}						
								</select>
							</td>
							<td><input style="float:left;" type="text" maxlength="12" id="idElementoCantidad" name="elementoCantidad" value=""></td>
							<td><button type="button" style="float:left;" id="idAgregarElemento" >Agregar</button></td>
						</tr>
					 </tbody>
					</table>
					
				</div>
				
			</div>
			
			
	
			
		<p>
			<button class="btn_green_button right" id="btnGuardarCambios" type="submit">Guardar cambios</button>
		</p>
	</form>
		
		
	<div class="fix"></div>
{% endblock form_content %}

{% block javascript_extra %}
	<script type="text/javascript" src="{{ asset('bundles/stock/js/solicitudmovimiento.js') }}" /></script>
	<script type="text/javascript">
		$(window).ready(function(){
			$('#solicitudmovimiento_elementos').val('');		
		});	
	</script>
	
{% endblock javascript_extra %}